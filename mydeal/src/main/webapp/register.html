<!doctype html>
<html lang="zxx">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>MyDeal</title>
    <link rel="icon" href="img/favicon.png">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <!-- animate CSS -->
    <link rel="stylesheet" href="css/animate.css">
    <!-- owl carousel CSS -->
    <link rel="stylesheet" href="css/owl.carousel.min.css">
    <!-- font awesome CSS -->
    <link rel="stylesheet" href="css/all.css">
    <!-- flaticon CSS -->
    <link rel="stylesheet" href="css/flaticon.css">
    <link rel="stylesheet" href="css/themify-icons.css">
    <!-- font awesome CSS -->
    <link rel="stylesheet" href="css/magnific-popup.css">
    <!-- swiper CSS -->
    <link rel="stylesheet" href="css/slick.css">
    <!-- style CSS -->
    <link rel="stylesheet" href="css/style.css">
    <style>
        .form-control.error {
            border: 1px solid red !important;
        }

        #error-message {
            color: red;
        }
    </style>
</head>

<body>
<!--::header part start::-->
<header class="main_menu home_menu">
    <div class="container">
        <div class="row align-items-center justify-content-center">
            <div class="col-lg-12">
                <nav class="navbar navbar-expand-lg navbar-light">
                    <a href="index.html">
                        <img src="img/logo.png" alt="logo">
                    </a>
                    <button class="navbar-toggler" type="button" data-toggle="collapse"
                            data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                            aria-expanded="false" aria-label="Toggle navigation">
                        <span class="menu_icon"><i class="fas fa-bars" href="index.ht"></i></span>
                    </button>

                    <div class="collapse navbar-collapse main-menu-item" id="navbarSupportedContent">
                        <ul class="navbar-nav">
                            <li class="nav-item" style="display: none;" id="homeTab">
                                <a class="nav-link" href="index.html">Home</a>
                            </li>
                            <li class="nav-item" style="display: none;" id="productsTab">
                                <a class="nav-link" href="product_list.html">Product List</a>
                            </li>
                            <li class="nav-item" id="historyTab" style="display: none;">
                                <a class="nav-link" href="#">Order History</a>
                            </li>
                            <li class="nav-item" style="display: none;" id="aboutTab">
                                <a class="nav-link" href="about.html">About</a>
                            </li>
                            <li class="nav-item" style="display: none;" id="contactTab">
                                <a class="nav-link" href="contact.html">Contact</a>
                            </li>
                            <li class="nav-item" id="loginTab" style="display: none;">
                                <a class="nav-link" href="login.html">Sign in</a>
                            </li>
                            <li class="nav-item" id="registerTab" style="display: none;">
                                <a class="nav-link" href="register.html">Sign up</a>
                            </li>
                            <li class="nav-item" id="logoutTab" style="display: none;">
                                <a class="nav-link" href="#">Sign out</a>
                            </li>
                        </ul>
                    </div>
                    <div class="hearer_icon d-flex align-items-center">
                        <a id="search_1" href="javascript:void(0)"><i class="ti-search"></i></a>
                        <a href="cart.html" id="cartIcon" style="display: none;">
                            <i class="flaticon-shopping-cart-black-shape"></i>
                        </a>
                        <!--                        Customer Update Info Page -->
                        <a href="user-info.html" id="profileIcon" style="display: none;">
                            <i class="fas fa-user"></i>
                        </a>
                    </div>
                </nav>
            </div>
        </div>
    </div>
</header>
<!-- Header part end-->

<!--================Register_part Area =================-->
<section class="login_part section_padding ">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-6 col-md-6">
                <div class="login_part_text text-center">
                    <div class="login_part_text_iner">
                        <h2>Already have an account ?</h2>
                        <p>if you are already one of MyDeal Customers , then Sign In here</p>
                        <a href="login.html" class="btn_3">Sign In now</a>
                    </div>
                </div>
            </div>
            <div class="col-lg-6 col-md-6">
                <div class="login_part_form">
                    <div class="login_part_form_iner">
                        <h3>Nice to meet you ! <br>
                            Sign up now</h3>
                        <form class="row contact_form" method="post">
                            <!-- User Name Field -->
                            <div class="col-md-12 form-group p_star">
                                <input type="text" class="form-control" id="name" name="username" value=""
                                       placeholder="Username" required>
                            </div>
                            <!-- Email Field -->
                            <div class="col-md-12 form-group p_star">
                                <input type="email" class="form-control" id="email" name="email" value=""
                                       placeholder="Email" required>
                                <label id="emailValidity"></label>
                            </div>
                            <!-- Phone Number Field -->
                            <div class="col-md-12 form-group p_star">
                                <input type="tel" class="form-control" id="phoneNumber" name="phone_number" value=""
                                       placeholder="Phone Number" pattern="(010|011|012|015)[0-9]{8}" required>
                                <label id="phoneValidity"></label>
                            </div>
                            <!-- DOB Field -->
                            <div class="col-md-12 form-group p_star">
                                <input type="date" class="form-control" id="dob" name="date_of_birth" value=""
                                       placeholder="Date of Birth" required>
                            </div>
                            <!-- Credit Limit Field -->
                            <div class="col-md-12 form-group p_star">
                                <input type="number" class="form-control" id="creditLimit" name="credit_limit" value=""
                                       placeholder="Credit Limit" step="0.01" min="1" required>
                            </div>
                            <!-- Street Field -->
                            <div class="col-md-12 form-group p_star">
                                <input type="text" class="form-control" id="street" name="street" value=""
                                       placeholder="Street" required>
                            </div>
                            <!-- City Field -->
                            <div class="col-md-12 form-group p_star">
                                <input type="text" class="form-control" id="city" name="city" value=""
                                       placeholder="City" required>
                            </div>
                            <!-- Apartment Field -->
                            <div class="col-md-12 form-group p_star">
                                <input type="number" class="form-control" id="apartment" name="apartment" value=""
                                       placeholder="Apartment" min="1" max="100" required>
                            </div>
                            <!-- Password Field -->
                            <div class="col-md-12 form-group p_star">
                                <input type="password" class="form-control" id="password" name="password" value=""
                                       placeholder="Password" required>
                            </div>
                            <!-- Confirm Password Field -->
                            <div class="col-md-12 form-group p_star">
                                <input type="password" class="form-control" id="confirmPassword" name="confirm_password"
                                       value=""
                                       placeholder="Confirm Password" required>
                            </div>
                            <div class="col-md-12 form-group">
                                <button type="submit" value="submit" class="btn_3" onclick="registerUser()">
                                    Register
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!--================login_part end =================-->

<!-- jquery plugins here-->
<script src="js/jquery-1.12.1.min.js"></script>
<!-- popper js -->
<script src="js/popper.min.js"></script>
<!-- bootstrap js -->
<script src="js/bootstrap.min.js"></script>
<!-- easing js -->
<script src="js/jquery.magnific-popup.js"></script>
<!-- swiper js -->
<script src="js/swiper.min.js"></script>
<!-- swiper js -->
<script src="js/mixitup.min.js"></script>
<!-- particles js -->
<script src="js/owl.carousel.min.js"></script>
<script src="js/jquery.nice-select.min.js"></script>
<!-- slick js -->
<script src="js/slick.min.js"></script>
<script src="js/jquery.counterup.min.js"></script>
<script src="js/waypoints.min.js"></script>
<script src="js/contact.js"></script>
<script src="js/jquery.ajaxchimp.min.js"></script>
<script src="js/jquery.form.js"></script>
<script src="js/jquery.validate.min.js"></script>
<script src="js/mail-script.js"></script>
<!-- custom js -->
<script src="js/custom.js"></script>
<script src="js/CustomerState.js"></script>
<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="js/CustomHeader.js"></script>
<!--Logic Part -->
<script>
    $(document).ready(function () {
        $('#emailValidity').hide();
        $('#phoneValidity').hide();
        $('#phoneNumber').on('blur', function () {
            var phoneNumber = $(this).val();
            if (phoneNumber.length == 0) {
                $('#phoneValidity').show();
                $('#phoneValidity').text(`You can't leave this Field Empty !!`).css("color", "red");
            } else if (phoneNumber.length == 11) {
                $('#phoneValidity').hide();
                // this means that we need to check on
                $.ajax({
                    url: 'validate', // Change this to the URL where you handle validation
                    type: 'POST',
                    data: {phone_number: phoneNumber},
                    success: function (response) {
                        if (response.trim() == 'valid') {
                            $('#phoneValidity').text('Phone Number is Valid ✅').css('color', 'green');
                        } else {
                            $('#phoneValidity').text('This phone number is already exist !!').css('color', 'red');
                        }
                    },
                    beforeSend: function () {
                        $('#phoneValidity').show();
                        $('#phoneValidity').text('Validating ...').css('color', 'grey');
                    }
                });
            } else {
                $('#phoneValidity').show();
                $('#phoneValidity').text('It must be 11 Digit !!');
            }
        });
        $('#email').on('blur', function () {
            var email = $(this).val();
            // check email  regex if it is valid :
            var re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (email.length == 0) {
                $('#emailValidity').show();
                $('#emailValidity').text("You Can't leave this field empty !!");
            } else if (email.length != 0 && re.test(email)) {
                $('#emailValidity').hide();
                $.ajax({
                    url: 'validate', // Change this to the URL where you handle validation
                    type: 'POST',
                    data: {email: email},
                    beforeSend: function () {
                        $('#emailValidity').show();
                        $('#emailValidity').text('Validating ...').css('color', 'grey');
                    },
                    success: function (response) {
                        if (response.trim() == 'valid') {
                            $('#emailValidity').show();
                            $('#emailValidity').text('Email is Valid ✅').css('color', 'green');
                        } else {
                            $('#emailValidity').show();
                            $('#emailValidity').text('This email is already exist !!').css('color', 'red');
                        }
                    }, onerror: function () {
                        $('#emailValidity').text('There is an error occurred').css('color', 'red');
                    }
                });
            } else {
                $('#emailValidity').show();
                $('#emailValidity').text("This is not valid email!!");
            }
        });
        $('form').on('submit', function (event) {
            var isValid = true;

            // Remove existing error messages
            $('.error-message').remove();

            // Validate each input field
            $(this).find('input[required]').each(function () {
                if (!$(this).val()) {
                    isValid = false;
                    $(this).addClass('error');
                    $(this).after('<span class="error-message">You can\'t leave this field empty !!</span>');
                } else {
                    $(this).removeClass('error');
                }
            });
            // Prevent form submission if validation fails
            if (!isValid) {
                event.preventDefault();
            }
        });
        $('input[required]').on('input', function () {
            $(this).removeClass('error');
            $(this).next('.error-message').remove();
        });
    });

    function storeDataLocally() {
        // Retrieve values from DOM elements
        var username = document.getElementById("name").value;
        var email = document.getElementById("email").value;
        var phoneNumber = document.getElementById("phoneNumber").value;
        var dobString = document.getElementById("dob").value;
        var dob = new Date(dobString); // Convert date string to Date object
        var creditLimit = parseFloat(document.getElementById("creditLimit").value); // Parse credit limit as float
        var street = document.getElementById("street").value;
        var city = document.getElementById("city").value;
        var apartment = parseInt(document.getElementById("apartment").value); // Parse apartment as integer
        var password = document.getElementById("password").value;
        // Store all data in Browser Local Storage :
        localStorage.setItem('username', username);
        localStorage.setItem('email', email);
        localStorage.setItem('phoneNumber', phoneNumber);
        localStorage.setItem('dob', dob.toString()); // Convert Date object to string
        localStorage.setItem('creditLimit', creditLimit.toString()); // Convert float to string
        localStorage.setItem('street', street);
        localStorage.setItem('city', city);
        localStorage.setItem('apartment', apartment.toString()); // Convert integer to string
        localStorage.setItem('password', password);
    }

    function registerUser() {
        // Serialize form data
        var formData = $('.contact_form').serialize();
        // Send AJAX request
        $.ajax({
            type: 'POST',
            url: 'register',
            data: formData,
            success: function (response) {
                storeDataLocally();
            },
            error: function (xhr, status, error) {
                // Handle error response
                console.error('Error registering user:', error);
                // You can show an error message to the user
            }
        });
        // Prevent form submission
        return false;
    }
</script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        var password = document.getElementById("password");
        var confirmPassword = document.getElementById("confirmPassword");

        function validatePassword() {
            if (password.value != confirmPassword.value) {
                confirmPassword.setCustomValidity("Passwords don't match");
            } else {
                confirmPassword.setCustomValidity('');
            }
        }

        password.onchange = validatePassword;
        confirmPassword.onkeyup = validatePassword;
    });
</script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        var dob = document.getElementById("dob");

        function validateDOB() {
            var enteredDOB = new Date(dob.value);
            var today = new Date();
            if (enteredDOB >= today) {
                dob.setCustomValidity("Date of birth must be in the past");
            } else {
                dob.setCustomValidity('');
            }
        }

        dob.onchange = validateDOB;
    });
</script>
</body>
</html>